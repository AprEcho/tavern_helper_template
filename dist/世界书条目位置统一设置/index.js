import{createPinia as e,defineStore as t}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';const o=Vue,n=t('worldbook-position-override',()=>({settings:(0,o.reactive)({enabled:!0,position:'before_character_definition',depth:1})})),r={class:'worldbook-position-override-settings'},i={class:'inline-drawer'},a={class:'inline-drawer-content'},l={class:'block'},d={class:'block'},s=['value'],c={key:0,class:'block'},p=(0,o.defineComponent)({__name:'app',setup(e){const{settings:t}=n(),p=[{value:'before_character_definition',text:'角色定义之前'},{value:'after_character_definition',text:'角色定义之后'},{value:'before_example_messages',text:'示例消息之前'},{value:'after_example_messages',text:'示例消息之后'},{value:'before_author_note',text:'作者注释之前'},{value:'after_author_note',text:'作者注释之后'},{value:'at_depth',text:'插入到指定深度'}];return(e,n)=>((0,o.openBlock)(),(0,o.createElementBlock)('div',r,[(0,o.createElementVNode)('div',i,[n[7]||(n[7]=(0,o.createElementVNode)('div',{class:'inline-drawer-toggle inline-drawer-header'},[(0,o.createElementVNode)('b',null,(0,o.toDisplayString)('世界书条目位置统一设置')),(0,o.createElementVNode)('div',{class:'inline-drawer-icon fa-solid fa-circle-chevron-down down'})],-1)),(0,o.createElementVNode)('div',a,[(0,o.createElementVNode)('div',l,[(0,o.withDirectives)((0,o.createElementVNode)('input',{'onUpdate:modelValue':n[0]||(n[0]=e=>(0,o.unref)(t).enabled=e),type:'checkbox'},null,512),[[o.vModelCheckbox,(0,o.unref)(t).enabled]]),n[3]||(n[3]=(0,o.createElementVNode)('label',null,(0,o.toDisplayString)('启用统一设置'),-1))]),(0,o.createElementVNode)('div',d,[n[4]||(n[4]=(0,o.createElementVNode)('label',{for:'wb-pos-override-type'},'插入位置: ',-1)),(0,o.withDirectives)((0,o.createElementVNode)('select',{id:'wb-pos-override-type','onUpdate:modelValue':n[1]||(n[1]=e=>(0,o.unref)(t).position=e),class:'text_pole'},[((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(p,e=>(0,o.createElementVNode)('option',{key:e.value,value:e.value},(0,o.toDisplayString)(e.text),9,s)),64))],512),[[o.vModelSelect,(0,o.unref)(t).position]])]),'at_depth'===(0,o.unref)(t).position?((0,o.openBlock)(),(0,o.createElementBlock)('div',c,[n[5]||(n[5]=(0,o.createElementVNode)('label',{for:'wb-pos-override-depth'},'插入深度: ',-1)),(0,o.withDirectives)((0,o.createElementVNode)('input',{id:'wb-pos-override-depth','onUpdate:modelValue':n[2]||(n[2]=e=>(0,o.unref)(t).depth=e),type:'number',class:'text_pole',min:'1'},null,512),[[o.vModelText,(0,o.unref)(t).depth,void 0,{number:!0}]])])):(0,o.createCommentVNode)('v-if',!0),n[6]||(n[6]=(0,o.createElementVNode)('hr',{class:'sysHR'},null,-1))])])]))}}),m=(0,o.createApp)(p).use(e());$(()=>{const e=$('<div>').attr('script_id',getScriptId());$('#extensions_settings2').append(e),function(){if($(`head > div[script_id="${getScriptId()}"]`).length>0)return;const e=$('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone());$('head').append(e)}(),m.mount(e[0])}),$(window).on('pagehide',()=>{m.unmount(),$(`head > div[script_id="${getScriptId()}"]`).remove(),$(`div[script_id="${getScriptId()}"]`).remove()});const u={before_character_definition:0,after_character_definition:1,before_example_messages:2,after_example_messages:3,before_author_note:4,after_author_note:5,at_depth:6};eventOn(tavern_events.WORLDINFO_ENTRIES_LOADED,e=>{const{settings:t}=n();if(!t.enabled)return;const o=[...e.globalLore,...e.characterLore,...e.chatLore,...e.personaLore],r=u[t.position];for(const e of o)e.position=r,'at_depth'===t.position&&(e.depth=t.depth)});
//# sourceMappingURL=index.js.map